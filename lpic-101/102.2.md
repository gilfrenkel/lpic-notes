# Linux LPIC-1: System Administrator

## Linux installation and Package management

### GRUB Legacy / GRUB2 

#### GRUB Legacy

GRUB Legacy is a bootloader, stands for GRand Unified Bootloader.
It was created to deal with the issues the older LILO bootloader had.

On boot, after BIOS hands the boot process to the bootloader
a menu will appear, listing the available boot options
for different kernels and configurations.
typically the top one will be the most updated.

Pressing "e" on one of the menu entries will allow you to
choose a line from the entry to edit

![Image](https://docs.oracle.com/cd/E36784_01/html/E36801/figures/bootscreen4.png)

Pressing "a" will allow you to append an argument to the kernel line
and "c" will drop you to grub command shell, while in edit mode "o" / "O" to add new line

##### GRUB and bootloader related files

In /boot we will find several important files

vmlinux-(version) - the kernel image
initrd-(version) - the init ram disk image
config-(version) - configuration parameters specific to kernel version
messeges - kernel messeges
symvers-(version) - compressed module listing compiled for the kernel

we will also find the grub folder,
in there we will find the stage files, used by grub to boot
and the menu.lst / grub.conf
which will have the grub configuration and menu entries


/boot/grub/grub.cfg
```
default=0
timeout=5

title  Arch Linux Stock Kernel
    root   (hd0,0)
    kernel /vmlinuz-linux root=/dev/sda2 ro
    initrd /initramfs-linux.img

title  Arch Linux Stock Kernel Fallback
    root   (hd0,0)
    kernel /vmlinuz-linux root=/dev/sda2 ro
    initrd /initramfs-linux-fallback.img
```

here we can change the grub default configuration and add/edit entries

##### GRUB Legacy related commands

\# grub
drop to the grub shell

\# grub-install [ /dev/sda | hd0 ]


#### GRUB2

GRUB2 was created as the modern replacement for GRUB Legacy
it has the same basic functionality, with the exeption
that it has support for advanced features, lie EFI/UEFI

The boot menu looks very similar to the GRUB Legacy

![Image](https://www.dedoimedo.com/images/computers_new_2/grub2-chainload.png)

with the exception of the missing "a" option to append arguments to kernel line

Pressing "e" to edit a menu entry will give you a nano-like editor, a typical
menu entry looks like this:


```
menuentry 'Arch Linux' --class arch --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-simple-f2ad4551-364a-46a2-9587-1cda69997a1e' {
	load_video
	set gfxpayload=keep
	insmod gzio
	insmod part_msdos
	insmod ext2
	set root='hd4,msdos1'
	if [ x$feature_platform_search_hint = xy ]; then
	  search --no-floppy --fs-uuid --set=root --hint-bios=hd4,msdos1 --hint-efi=hd4,msdos1 --hint-baremetal=ahci4,msdos1  e58dasda13-dasd6b-gfdde-aas02-26asd5d26d95e
	else
	  search --no-floppy --fs-uuid --set=root e5840a43-d216b-4213de-ab12342-26523d95e
	fi
	echo	'Loading Linux linux ...'
	linux	/vmlinuz-linux root=UUID=f2234551-36asada-46a3249587-1c1234a69997a1e rw  quiet
	echo	'Loading initial ramdisk ...'
	initrd  /intel-ucode.img /initramfs-linux.img
}

```

this configuration also is a part  of the grub.cfg file
the /boot/grub/grub.cfg file contains the whole configuration
and it is generated by the grub-mkconfig command from scripts
located in /etc/grub.d/ and /etc/default/grub.

/etc/default/grub
```
GRUB_DEFAULT=0
GRUB_HIDDEN_TIMEOUT=0
GRUB_HIDDEN_TIMEOUT_QUIET=true
GRUB_TIMEOUT=10
GRUB_DISTRIBUTOR=`lsb_release -i -s 2> /dev/null || echo Debian`
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"
GRUB_CMDLINE_LINUX=""
```
this allows basic configuration of grub

/etc/grub.d/
contains SysVinit style scripts that are numerically ordered
and are used to create /boot/grub/grub.cfg

##### GRUB2 related commands


\# grub-mkconfig / grub2-mkconfig
prints the configuration file(which should be located in /boot/grub/grub.cfg)
to STDIN

example:
```
# grub-mkconfig -o /dev/null
```
will send the configuration file to oblivion.


\# grub2-install / grub-install

installs the bootloader to a device.
```
# grub-install /dev/sda
```
will install grub to the first hard disk

another option is to define a different boot directory
```
# grub2-install --boot-directory=/mnt/root/boot /dev/sda
```
will install the images to a directory other than /boot (/mnt/root/boot in this example)
